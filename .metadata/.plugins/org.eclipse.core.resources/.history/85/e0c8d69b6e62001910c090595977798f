package temp_pub_sub;

import javax.jms.Message;
import javax.jms.MessageProducer;
import javax.jms.Session;
import javax.jms.TextMessage;
import javax.jms.Topic;

import org.apache.activemq.ActiveMQConnection;
import org.apache.activemq.ActiveMQConnectionFactory;

public class pub {
		public static void main(String [] args) throws Exception {
			String url = ActiveMQConnection.DEFAULT_BROKER_URL;
			ActiveMQConnectionFactory fac = new ActiveMQConnectionFactory(url);
			//the above is important, passing of url
			ActiveMQConnection con = (ActiveMQConnection) fac.createConnection();
			Session session = con.createSession(false,Session.AUTO_ACKNOWLEDGE);
			//the above is important
			Topic topic = session.createTopic("sample");
			MessageProducer producer =  session.createProducer(topic);//destination is the topic
			TextMessage message = session.createTextMessage();
			//IMPORTANT: the above is a textMessage not a message
			message.setText("HEY NISHANT!");
			producer.send(message);// this is important as well, producer sends the message, although u would know by testing evreything
		}
}
